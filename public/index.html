<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒêƒÉng Nh·∫≠p - Theo D√µi Thi ƒêua</title>

    <!-- SEO & Open Graph Meta Tags -->
    <meta name="description" content="H·ªá th·ªëng theo d√µi thi ƒëua h·ªçc sinh - Qu·∫£n l√Ω ƒëi·ªÉm, vi ph·∫°m v√† x·∫øp h·∫°ng l·ªõp h·ªçc">
    <meta name="theme-color" content="#6366f1">

    <!-- Open Graph / Facebook / Discord -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://thidualop10-5.up.railway.app/">
    <meta property="og:title" content="üèÜ H·ªá Th·ªëng Thi ƒêua H·ªçc Sinh">
    <meta property="og:description" content="Theo d√µi ƒëi·ªÉm thi ƒëua, vi ph·∫°m v√† x·∫øp h·∫°ng l·ªõp h·ªçc m·ªôt c√°ch d·ªÖ d√†ng">
    <meta property="og:image" content="https://thidualop10-5.up.railway.app/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="üèÜ H·ªá Th·ªëng Thi ƒêua H·ªçc Sinh">
    <meta name="twitter:description" content="Theo d√µi ƒëi·ªÉm thi ƒëua, vi ph·∫°m v√† x·∫øp h·∫°ng l·ªõp h·ªçc m·ªôt c√°ch d·ªÖ d√†ng">
    <meta name="twitter:image" content="https://thidualop10-5.up.railway.app/og-image.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
    <div class="bg-gradient"></div>

    <div class="login-container">
        <div class="login-box">
            <h1>üèÜ Thi ƒêua</h1>
            <p class="subtitle">H·ªá th·ªëng theo d√µi thi ƒëua h·ªçc sinh</p>

            <div class="login-tabs">
                <button class="login-tab active" data-tab="student">H·ªçc sinh</button>
                <button class="login-tab" data-tab="admin">Qu·∫£n tr·ªã</button>
            </div>

            <div class="error-message" id="errorMessage"></div>

            <!-- Student Login Form -->
            <form class="login-form active" id="studentForm" data-tab="student">
                <div class="form-group">
                    <label>M√£ s·ªë h·ªçc sinh</label>
                    <input type="text" id="studentCode" placeholder="Nh·∫≠p m√£ s·ªë c·ªßa b·∫°n" required>
                </div>
                <button type="submit" class="btn btn-primary">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
                        <polyline points="10 17 15 12 10 7"></polyline>
                        <line x1="15" y1="12" x2="3" y2="12"></line>
                    </svg>
                    ƒêƒÉng nh·∫≠p
                </button>
            </form>

            <!-- Admin Login Form -->
            <form class="login-form" id="adminForm" data-tab="admin">
                <div class="form-group">
                    <label>T√†i kho·∫£n</label>
                    <input type="text" id="adminUsername" placeholder="admin" required>
                </div>
                <div class="form-group">
                    <label>M·∫≠t kh·∫©u</label>
                    <input type="password" id="adminPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <button type="submit" class="btn btn-primary">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                    </svg>
                    ƒêƒÉng nh·∫≠p Admin
                </button>
            </form>
        </div>
    </div>

    <script>
        // Tab switching
        document.querySelectorAll('.login-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.login-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.login-form').forEach(f => f.classList.remove('active'));

                tab.classList.add('active');
                document.querySelector(`.login-form[data-tab="${tab.dataset.tab}"]`).classList.add('active');

                hideError();
            });
        });

        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
        }

        function hideError() {
            document.getElementById('errorMessage').style.display = 'none';
        }

        // Student login
        document.getElementById('studentForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            hideError();

            const studentCode = document.getElementById('studentCode').value.trim();

            try {
                const res = await fetch('/api/auth/student/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ studentCode })
                });

                const data = await res.json();

                if (res.ok) {
                    window.location.href = '/user';
                } else {
                    showError(data.error);
                }
            } catch (err) {
                showError('L·ªói k·∫øt n·ªëi server');
            }
        });

        // Admin login
        document.getElementById('adminForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            hideError();

            const username = document.getElementById('adminUsername').value.trim();
            const password = document.getElementById('adminPassword').value;

            try {
                const res = await fetch('/api/auth/admin/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                const data = await res.json();

                if (res.ok) {
                    window.location.href = '/admin';
                } else {
                    showError(data.error);
                }
            } catch (err) {
                showError('L·ªói k·∫øt n·ªëi server');
            }
        });

        // Check if already logged in
        (async () => {
            try {
                const res = await fetch('/api/auth/session');
                const data = await res.json();

                if (data.type === 'admin') {
                    window.location.href = '/admin';
                } else if (data.type === 'student') {
                    window.location.href = '/user';
                }
            } catch (err) { }
        })();
    </script>
</body>

</html>